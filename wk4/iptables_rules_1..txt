man iptables
IPTABLES(8)                                              iptables 1.8.10                                             IPTABLES(8)

NAME
       iptables/ip6tables — administration tool for IPv4/IPv6 packet filtering and NAT

SYNOPSIS
       iptables [-t table] {-A|-C|-D|-V} chain rule-specification

       ip6tables [-t table] {-A|-C|-D|-V} chain rule-specification

       iptables [-t table] -I chain [rulenum] rule-specification

       iptables [-t table] -R chain rulenum rule-specification

       iptables [-t table] -D chain rulenum

       iptables [-t table] -S [chain [rulenum]]

       iptables [-t table] {-F|-L|-Z} [chain [rulenum]] [options...]

       iptables [-t table] -N chain

       iptables [-t table] -X [chain]

       iptables [-t table] -P chain target

       iptables [-t table] -E old-chain-name new-chain-name

       rule-specification = [matches...] [target]

       match = -m matchname [per-match-options]

       target = -j targetname [per-target-options]

DESCRIPTION
       Iptables  and  ip6tables are used to set up, maintain, and inspect the tables of IPv4 and IPv6 packet filter rules in the
       Linux kernel.  Several different tables may be defined.  Each table contains a number of built-in  chains  and  may  also
       contain user-defined chains.

       Each  chain  is  a  list  of  rules  which can match a set of packets.  Each rule specifies what to do with a packet that
       matches.  This is called a `target', which may be a jump to a user-defined chain in the same table.
TARGETS
       A firewall rule specifies criteria for a packet and a target.  If the packet does not match, the next rule in  the  chain
       is  examined;  if  it  does match, then the next rule is specified by the value of the target, which can be the name of a
       user-defined chain, one of the targets described in iptables-extensions(8), or one of the special values ACCEPT, DROP  or
       RETURN.

       ACCEPT  means  to let the packet through.  DROP means to drop the packet on the floor.  RETURN means stop traversing this
       chain and resume at the next rule in the previous (calling) chain.  If the end of a built-in chain is reached or  a  rule
       in  a  built-in  chain with target RETURN is matched, the target specified by the chain policy determines the fate of the
       packet.

TABLES
       There are currently five independent tables (which tables are present at any time depends on the kernel configuration op‐
       tions and which modules are present).

       -t, --table table
              This option specifies the packet matching table which the command should operate on.  If the kernel is  configured
              with  automatic module loading, an attempt will be made to load the appropriate module for that table if it is not
              already there.

              The tables are as follows:

              filter:
                  This is the default table (if no -t option is passed). It contains the built-in chains INPUT (for packets des‐
                  tined to local sockets), FORWARD (for packets being routed through the box), and OUTPUT (for locally-generated
                  packets).

              nat:
                  This table is consulted when a packet that creates a new connection  is  encountered.   It  consists  of  four
                  built-ins: PREROUTING (for altering packets as soon as they come in), INPUT (for altering packets destined for
                  local  sockets), OUTPUT (for altering locally-generated packets before routing), and POSTROUTING (for altering



                  OPTIONS
       The options that are recognized by iptables and ip6tables can be divided into several different groups.

   COMMANDS
       These  options specify the desired action to perform. Only one of them can be specified on the command line unless
       otherwise stated below. For long versions of the command and option names, you need to use only enough letters  to
       ensure that iptables can differentiate it from all other options.

       -A, --append chain rule-specification
              Append  one  or  more rules to the end of the selected chain.  When the source and/or destination names re‐
              solve to more than one address, a rule will be added for each possible address combination.

       -C, --check chain rule-specification
              Check whether a rule matching the specification does exist in the selected chain.  This  command  uses  the
              same  logic as -D to find a matching entry, but does not alter the existing iptables configuration and uses
              its exit code to indicate success or failure.

       -D, --delete chain rule-specification
       -D, --delete chain rulenum
              Delete one or more rules from the selected chain.  There are two versions of this command: the rule can  be
              specified as a number in the chain (starting at 1 for the first rule) or a rule to match.

       -I, --insert chain [rulenum] rule-specification
              Insert  one or more rules in the selected chain as the given rule number.  So, if the rule number is 1, the
              rule or rules are inserted at the head of the chain.  This is also the default if no rule number is  speci‐
              fied.

       -R, --replace chain rulenum rule-specification
              Replace  a  rule  in  the  selected  chain.  If the source and/or destination names resolve to multiple ad‐
              dresses, the command will fail.  Rules are numbered starting at 1.

       -L, --list [chain]
              List all rules in the selected chain.  If no chain is selected, all chains are  listed.  Like  every  other
              iptables command, it applies to the specified table (filter is the default), so NAT rules get listed by
               iptables -t nat -n -L
              Please  note  that  it is often used with the -n option, in order to avoid long reverse DNS lookups.  It is
              legal to specify the -Z (zero) option as well, in which case the chain(s) will be atomically listed and ze‐
              roed.  The exact output is affected by the other arguments given. The exact rules are suppressed until  you
              use
               iptables -L -v
              or iptables-save(8).

       -S, --list-rules [chain]
              Print all rules in the selected chain.  If no chain is selected, all chains are printed like iptables-save.
              Like every other iptables command, it applies to the specified table (filter is the default).

       -F, --flush [chain]
              Flush  the  selected  chain (all the chains in the table if none is given).  This is equivalent to deleting
              all the rules one by one.




iptables -L -v

 root@lamp-ubuntu-s-1vcpu-1gb-tor1-01:~# iptables -L -v
Chain INPUT (policy DROP 418K packets, 20M bytes)
 pkts bytes target     prot opt in     out     source               destination
1081K  589M ufw-before-logging-input  all  --  any    any     anywhere             anywhere
1081K  589M ufw-before-input  all  --  any    any     anywhere             anywhere
 420K   20M ufw-after-input  all  --  any    any     anywhere             anywhere
 418K   20M ufw-after-logging-input  all  --  any    any     anywhere             anywhere
 418K   20M ufw-reject-input  all  --  any    any     anywhere             anywhere
 418K   20M ufw-track-input  all  --  any    any     anywhere             anywhere

Chain FORWARD (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ufw-before-logging-forward  all  --  any    any     anywhere             anywhere
    0     0 ufw-before-forward  all  --  any    any     anywhere             anywhere
    0     0 ufw-after-forward  all  --  any    any     anywhere             anywhere
    0     0 ufw-after-logging-forward  all  --  any    any     anywhere             anywhere
    0     0 ufw-reject-forward  all  --  any    any     anywhere             anywhere
    0     0 ufw-track-forward  all  --  any    any     anywhere             anywhere

Chain OUTPUT (policy ACCEPT 4718 packets, 359K bytes)
 pkts bytes target     prot opt in     out     source               destination
 983K  157M ufw-before-logging-output  all  --  any    any     anywhere             anywhere
 983K  157M ufw-before-output  all  --  any    any     anywhere             anywhere
16556 1250K ufw-after-output  all  --  any    any     anywhere             anywhere
16556 1250K ufw-after-logging-output  all  --  any    any     anywhere             anywhere
16556 1250K ufw-reject-output  all  --  any    any     anywhere             anywhere
16556 1250K ufw-track-output  all  --  any    any     anywhere             anywhere

Chain ufw-after-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-after-input (1 references)
 pkts bytes target     prot opt in     out     source               destination
  227 17710 ufw-skip-to-policy-input  udp  --  any    any     anywhere             anywhere             udp dpt:netbios-ns
    0     0 ufw-skip-to-policy-input  udp  --  any    any     anywhere             anywhere             udp dpt:netbios-dgm
  426 21828 ufw-skip-to-policy-input  tcp  --  any    any     anywhere             anywhere             tcp dpt:netbios-ssn
 1512 72876 ufw-skip-to-policy-input  tcp  --  any    any     anywhere             anywhere             tcp dpt:microsoft-ds
    0     0 ufw-skip-to-policy-input  udp  --  any    any     anywhere             anywhere             udp dpt:bootps
    0     0 ufw-skip-to-policy-input  udp  --  any    any     anywhere             anywhere             udp dpt:bootpc
    0     0 ufw-skip-to-policy-input  all  --  any    any     anywhere             anywhere             ADDRTYPE match dst-type BROADCAST

Chain ufw-after-logging-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 LOG        all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 10 LOG level warn prefix "[UFW BLOCK] "

Chain ufw-after-logging-input (1 references)
 pkts bytes target     prot opt in     out     source               destination
76082 3534K LOG        all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 10 LOG level warn prefix "[UFW BLOCK] "

Chain ufw-after-logging-output (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-after-output (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-before-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     all  --  any    any     anywhere             anywhere             ctstate RELATED,ESTABLISHED
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp destination-unreachable
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp time-exceeded
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp parameter-problem
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp echo-request
    0     0 ufw-user-forward  all  --  any    any     anywhere             anywhere

Chain ufw-before-input (1 references)
 pkts bytes target     prot opt in     out     source               destination
 7063  720K ACCEPT     all  --  lo     any     anywhere             anywhere
 535K  560M ACCEPT     all  --  any    any     anywhere             anywhere             ctstate RELATED,ESTABLISHED
 3851  327K ufw-logging-deny  all  --  any    any     anywhere             anywhere             ctstate INVALID
 3851  327K DROP       all  --  any    any     anywhere             anywhere             ctstate INVALID
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp destination-unreachable
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp time-exceeded
    0     0 ACCEPT     icmp --  any    any     anywhere             anywhere             icmp parameter-problem
56722 3760K ACCEPT     icmp --  any    any     anywhere             anywhere             icmp echo-request
    0     0 ACCEPT     udp  --  any    any     anywhere             anywhere             udp spt:bootps dpt:bootpc
 478K   24M ufw-not-local  all  --  any    any     anywhere             anywhere
    0     0 ACCEPT     udp  --  any    any     anywhere             mdns.mcast.net       udp dpt:mdns
    0     0 ACCEPT     udp  --  any    any     anywhere             239.255.255.250      udp dpt:1900
 478K   24M ufw-user-input  all  --  any    any     anywhere             anywhere

Chain ufw-before-logging-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-before-logging-input (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-before-logging-output (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-before-output (1 references)
 pkts bytes target     prot opt in     out     source               destination
 7063  720K ACCEPT     all  --  any    lo      anywhere             anywhere
 960K  155M ACCEPT     all  --  any    any     anywhere             anywhere             ctstate RELATED,ESTABLISHED
16556 1250K ufw-user-output  all  --  any    any     anywhere             anywhere

Chain ufw-logging-allow (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 LOG        all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 10 LOG level warn prefix "[UFW ALLOW] "

Chain ufw-logging-deny (2 references)
 pkts bytes target     prot opt in     out     source               destination
 3046  289K RETURN     all  --  any    any     anywhere             anywhere             ctstate INVALID limit: avg 3/min burst 10
   59  2824 LOG        all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 10 LOG level warn prefix "[UFW BLOCK] "

Chain ufw-not-local (1 references)
 pkts bytes target     prot opt in     out     source               destination
 478K   24M RETURN     all  --  any    any     anywhere             anywhere             ADDRTYPE match dst-type LOCAL
    0     0 RETURN     all  --  any    any     anywhere             anywhere             ADDRTYPE match dst-type MULTICAST
    0     0 RETURN     all  --  any    any     anywhere             anywhere             ADDRTYPE match dst-type BROADCAST
    0     0 ufw-logging-deny  all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 10
    0     0 DROP       all  --  any    any     anywhere             anywhere

Chain ufw-reject-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-reject-input (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-reject-output (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-skip-to-policy-forward (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 DROP       all  --  any    any     anywhere             anywhere

Chain ufw-skip-to-policy-input (7 references)
 pkts bytes target     prot opt in     out     source               destination
 2165  112K DROP       all  --  any    any     anywhere             anywhere

Chain ufw-skip-to-policy-output (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     all  --  any    any     anywhere             anywhere

Chain ufw-track-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-track-input (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-track-output (1 references)
 pkts bytes target     prot opt in     out     source               destination
 6470  450K ACCEPT     tcp  --  any    any     anywhere             anywhere             ctstate NEW
 5368  441K ACCEPT     udp  --  any    any     anywhere             anywhere             ctstate NEW

Chain ufw-user-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-user-input (1 references)
 pkts bytes target     prot opt in     out     source               destination
35910 2107K            tcp  --  any    any     anywhere             anywhere             tcp dpt:ssh ctstate NEW recent: SET name: DEFAULT side: source mask: 255.255.255.255
  739 43688 ufw-user-limit  tcp  --  any    any     anywhere             anywhere             tcp dpt:ssh ctstate NEW recent: UPDATE seconds: 30 hit_count: 6 name: DEFAULT side: source mask: 255.255.255.255
35171 2063K ufw-user-limit-accept  tcp  --  any    any     anywhere             anywhere             tcp dpt:ssh
15228  829K ACCEPT     tcp  --  any    any     anywhere             anywhere             multiport dports http,https /* 'dapp_Apache%20Full' */

Chain ufw-user-limit (1 references)
 pkts bytes target     prot opt in     out     source               destination
  181 10612 LOG        all  --  any    any     anywhere             anywhere             limit: avg 3/min burst 5 LOG level warn prefix "[UFW LIMIT BLOCK] "
  739 43688 REJECT     all  --  any    any     anywhere             anywhere             reject-with icmp-port-unreachable

Chain ufw-user-limit-accept (1 references)
 pkts bytes target     prot opt in     out     source               destination
35171 2063K ACCEPT     all  --  any    any     anywhere             anywhere

Chain ufw-user-logging-forward (0 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-user-logging-input (0 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-user-logging-output (0 references)
 pkts bytes target     prot opt in     out     source               destination

Chain ufw-user-output (1 references)
 pkts bytes target     prot opt in     out     source               destination
